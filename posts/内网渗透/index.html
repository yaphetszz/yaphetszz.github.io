<!doctype html>
<html lang="en">
  <head>
    <title>内网渗透备忘录 // Y4ph3tS blog</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.139.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Y4ph3tS" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="内网渗透备忘录">
  <meta name="twitter:description" content="本文所述的一切技术仅供网络安全研究学习之用，请勿用于任何的违法用途，否则由此所产生的一切后果自负！ 本来是个xmind脑图，用于内网渗透的时候提供备忘思路，从xmind转换为md格式，可点击附件菜单获取xmind文件
内网渗透 基础知识 大型内网域环境 父域控制器 子域控制器 辅域控制器 域内主机 域内服务器 Windows NTLM认证原理 Kerberos域内认证原理 内网信息收集 工作组和大型内网信息收集基础 本机密码
Windows2012高版本收集
Windows2012以下低版本收集
Linux下密码收集
收集特定密码文件 指定用户命令历史记录明文密码 无线密码获取
注册表敏感键值信息
数据库中的密码
Mysql SQL Server … 本地储存的密码
本地密码本 Windows常用软件密码 浏览器信息
Chrome Firefox 360 IE VPN和代理
VPN 代理服务器 数据库信息
Mysql
SQL Server
Oracle
PostgreSQL
LDAP
通过LDAP定位核心机器 通过LDAP获取内网架构分布 通过LDAP获取内网组织架构 通过LDAP获取域内核心机器 判断协议出网
获取详细网络配置
Hosts 所在域 IP 掩码 网关 主备DNS ip IPC连接情况 共享目录 用户登录记录
用户命令记录
屏幕抓取敏感信息
环境变量信息
远程控制服务情况
RDP SSH VNC 安装的软件列表">

    <meta property="og:url" content="https://yaphetszz.github.io/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">
  <meta property="og:site_name" content="Y4ph3tS blog">
  <meta property="og:title" content="内网渗透备忘录">
  <meta property="og:description" content="本文所述的一切技术仅供网络安全研究学习之用，请勿用于任何的违法用途，否则由此所产生的一切后果自负！ 本来是个xmind脑图，用于内网渗透的时候提供备忘思路，从xmind转换为md格式，可点击附件菜单获取xmind文件
内网渗透 基础知识 大型内网域环境 父域控制器 子域控制器 辅域控制器 域内主机 域内服务器 Windows NTLM认证原理 Kerberos域内认证原理 内网信息收集 工作组和大型内网信息收集基础 本机密码
Windows2012高版本收集
Windows2012以下低版本收集
Linux下密码收集
收集特定密码文件 指定用户命令历史记录明文密码 无线密码获取
注册表敏感键值信息
数据库中的密码
Mysql SQL Server … 本地储存的密码
本地密码本 Windows常用软件密码 浏览器信息
Chrome Firefox 360 IE VPN和代理
VPN 代理服务器 数据库信息
Mysql
SQL Server
Oracle
PostgreSQL
LDAP
通过LDAP定位核心机器 通过LDAP获取内网架构分布 通过LDAP获取内网组织架构 通过LDAP获取域内核心机器 判断协议出网
获取详细网络配置
Hosts 所在域 IP 掩码 网关 主备DNS ip IPC连接情况 共享目录 用户登录记录
用户命令记录
屏幕抓取敏感信息
环境变量信息
远程控制服务情况
RDP SSH VNC 安装的软件列表">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-08-12T03:44:31+08:00">
    <meta property="article:modified_time" content="2018-08-12T03:44:31+08:00">
    <meta property="article:tag" content="内网渗透">
    <meta property="article:tag" content="红队技术">


  </head>
  <body>
    <header class="app-header">
      <a href="https://yaphetszz.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="Y4ph3tS" /></a>
      <span class="app-header-title">Y4ph3tS blog</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">主页</a>
             - 
          
          <a class="app-header-menu-item" href="/categories/">分类</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">标签</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">关于</a>
             - 
          
          <a class="app-header-menu-item" href="/links/">友链</a>
             - 
          
          <a class="app-header-menu-item" href="/atta/">附件</a>
      </nav>
      <p>Valar Morghulis</p>
      <div class="app-header-social">
        
          <a href="https://github.com/yaphetszz" target="_blank" rel="noreferrer noopener me">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">内网渗透备忘录</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Aug 12, 2018
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          
          3781 Words - 
          
          7 min read
        </div>
          <p>创建时间: 2018-08-12 03:44</p>
        
           
          
          <p>最后修改时间: 2024-12-01 11:00</p>
          
        
        <div>
          <svg class="icon icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
              <a class="tag" href="https://yaphetszz.github.io/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">内网渗透</a>
              <a class="tag" href="https://yaphetszz.github.io/tags/%E7%BA%A2%E9%98%9F%E6%8A%80%E6%9C%AF/">红队技术</a>
        </div>
        <div>
          <p></p>
          <p>文章分类:    </p>
              <a class="tag" href="https://yaphetszz.github.io/categories/%E6%94%BB%E9%98%B2%E6%B8%97%E9%80%8F/">攻防渗透</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <p><strong>本文所述的一切技术仅供网络安全研究学习之用，请勿用于任何的违法用途，否则由此所产生的一切后果自负！</strong>
本来是个xmind脑图，用于内网渗透的时候提供备忘思路，从xmind转换为md格式，可点击<a href="/atta">附件菜单</a>获取xmind文件</p>
<h1 id="内网渗透">内网渗透</h1>
<h2 id="基础知识">基础知识</h2>
<h3 id="大型内网域环境">大型内网域环境</h3>
<ul>
<li>父域控制器</li>
<li>子域控制器</li>
<li>辅域控制器</li>
<li>域内主机</li>
<li>域内服务器</li>
</ul>
<h3 id="windows-ntlm认证原理">Windows NTLM认证原理</h3>
<h3 id="kerberos域内认证原理">Kerberos域内认证原理</h3>
<h2 id="内网信息收集">内网信息收集</h2>
<h3 id="工作组和大型内网信息收集基础">工作组和大型内网信息收集基础</h3>
<ul>
<li>
<p>本机密码</p>
<ul>
<li>
<p>Windows2012高版本收集</p>
</li>
<li>
<p>Windows2012以下低版本收集</p>
</li>
<li>
<p>Linux下密码收集</p>
<ul>
<li>收集特定密码文件</li>
<li>指定用户命令历史记录明文密码</li>
</ul>
</li>
<li>
<p>无线密码获取</p>
</li>
<li>
<p>注册表敏感键值信息</p>
</li>
<li>
<p>数据库中的密码</p>
<ul>
<li>Mysql</li>
<li>SQL Server</li>
<li>&hellip;</li>
</ul>
</li>
<li>
<p>本地储存的密码</p>
<ul>
<li>本地密码本</li>
<li>Windows常用软件密码</li>
</ul>
</li>
</ul>
</li>
<li>
<p>浏览器信息</p>
<ul>
<li>Chrome</li>
<li>Firefox</li>
<li>360</li>
<li>IE</li>
</ul>
</li>
<li>
<p>VPN和代理</p>
<ul>
<li>VPN</li>
<li>代理服务器</li>
</ul>
</li>
<li>
<p>数据库信息</p>
<ul>
<li>
<p>Mysql</p>
</li>
<li>
<p>SQL Server</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>LDAP</p>
<ul>
<li>通过LDAP定位核心机器</li>
<li>通过LDAP获取内网架构分布</li>
<li>通过LDAP获取内网组织架构</li>
<li>通过LDAP获取域内核心机器</li>
</ul>
</li>
</ul>
</li>
<li>
<p>判断协议出网</p>
</li>
<li>
<p>获取详细网络配置</p>
<ul>
<li>Hosts</li>
<li>所在域</li>
<li>IP</li>
<li>掩码</li>
<li>网关</li>
<li>主备DNS ip</li>
<li>IPC连接情况</li>
<li>共享目录</li>
</ul>
</li>
<li>
<p>用户登录记录</p>
</li>
<li>
<p>用户命令记录</p>
</li>
<li>
<p>屏幕抓取敏感信息</p>
</li>
<li>
<p>环境变量信息</p>
</li>
<li>
<p>远程控制服务情况</p>
<ul>
<li>RDP</li>
<li>SSH</li>
<li>VNC</li>
</ul>
</li>
<li>
<p>安装的软件列表</p>
<ul>
<li>安全防护软件</li>
<li>其他软件</li>
</ul>
</li>
<li>
<p>安装的补丁列表</p>
</li>
<li>
<p>用户桌面、用户目录、回收站</p>
</li>
<li>
<p>&hellip;</p>
</li>
</ul>
<h3 id="web信息">Web信息</h3>
<ul>
<li>
<p>Web页面</p>
</li>
<li>
<p>Web框架</p>
<ul>
<li>Tomcat</li>
<li>Solr</li>
<li>Struts</li>
<li>Weblogic</li>
<li>Jboss</li>
<li>&hellip;</li>
</ul>
</li>
<li>
<p>登录入口</p>
</li>
</ul>
<h3 id="内网邮箱">内网邮箱</h3>
<ul>
<li>
<p>企业内网邮箱信息收集</p>
<ul>
<li>整体分析</li>
<li>钓鱼构造</li>
<li>通讯录</li>
<li>历史联系人</li>
<li>&hellip;</li>
</ul>
</li>
<li>
<p>Exchange</p>
</li>
</ul>
<h3 id="内网存活主机检测">内网存活主机检测</h3>
<ul>
<li>TCP</li>
<li>UDP</li>
<li>ARP</li>
<li>ICMP</li>
<li>NetBIOS</li>
</ul>
<h3 id="客户端软件">客户端软件</h3>
<ul>
<li>
<p>远程管理</p>
<ul>
<li>向日葵</li>
<li>Finalshell</li>
<li>Teamviewer</li>
<li>Xshell</li>
</ul>
</li>
<li>
<p>FTP</p>
<ul>
<li>XFtp</li>
<li>WinSCP</li>
<li>FileZilla</li>
<li>&hellip;</li>
</ul>
</li>
</ul>
<h3 id="超大型内网思路">超大型内网思路</h3>
<ul>
<li>A段</li>
<li>B段</li>
</ul>
<h2 id="内网穿透流量代理端口转发">内网穿透、流量代理、端口转发</h2>
<h3 id="出网情况判断">出网情况判断</h3>
<ul>
<li>TCP/UDP</li>
<li>ICMP</li>
<li>DNS</li>
<li>HTTP</li>
<li>HTTPS</li>
</ul>
<h3 id="正反向代理工具">正反向代理工具</h3>
<ul>
<li>MSF</li>
<li>CS</li>
<li>Proxychains</li>
<li>SSocks</li>
<li>frp</li>
<li>&hellip;</li>
</ul>
<h3 id="端口转发">端口转发</h3>
<ul>
<li>lcx</li>
<li>MSF</li>
<li>netsh</li>
<li>iptables</li>
<li>powershell</li>
</ul>
<h3 id="内网穿透工具">内网穿透工具</h3>
<ul>
<li>frp</li>
<li>NPS</li>
<li>spp</li>
<li>venom</li>
<li>自研</li>
</ul>
<h3 id="不出网上线方式">不出网上线方式</h3>
<ul>
<li>DNS</li>
<li>HTTP</li>
<li>ICMP</li>
<li>SMB</li>
</ul>
<h3 id="不出网主机的内网穿透和流量代理">不出网主机的内网穿透和流量代理</h3>
<ul>
<li>iodine</li>
<li>reGeorg</li>
<li>Neo-reGeorg</li>
</ul>
<h2 id="提权">提权</h2>
<h3 id="windows">Windows</h3>
<ul>
<li>
<p>内核溢出</p>
</li>
<li>
<p>土豆系列</p>
</li>
<li>
<p>第三方服务</p>
</li>
<li>
<p>系统错误配置</p>
</li>
<li>
<p>Bypass UAC</p>
</li>
<li>
<p>数据库</p>
<ul>
<li>Mysql UDF</li>
<li>Mysql MOF</li>
<li>SQL Server xp_cmdshell</li>
<li>SQL Server SP_oacreate</li>
<li>SQL Server其他提权</li>
<li>&hellip;.</li>
</ul>
</li>
</ul>
<h3 id="linux">Linux</h3>
<ul>
<li>内核溢出</li>
<li>SUID</li>
<li>错误配置</li>
<li>计划任务</li>
<li>高权限服务</li>
<li>环境变量劫持</li>
<li>sudo提权</li>
</ul>
<h2 id="c2深度分析">C2深度分析</h2>
<ul>
<li>
<p>MSF</p>
</li>
<li>
<p>CS</p>
</li>
<li>
<p>Poshc2</p>
</li>
<li>
<p>TSH</p>
</li>
</ul>
<h2 id="内网横向移动">内网横向移动</h2>
<ul>
<li>
<p>MSF下的横向</p>
</li>
<li>
<p>CS下的横向</p>
</li>
<li>
<p>PsExec</p>
</li>
<li>
<p>SMBExec</p>
</li>
<li>
<p>WMIExec</p>
</li>
<li>
<p>IPC命令</p>
<ul>
<li>at定时任务</li>
<li>schtasks定时任务</li>
<li>Wmic</li>
<li>Wmi</li>
<li>WinRm</li>
</ul>
</li>
<li>
<p>PTH</p>
</li>
</ul>
<h2 id="域内攻击">域内攻击</h2>
<ul>
<li>
<p>从域外对域内的信息收集</p>
</li>
<li>
<p>域外密码喷洒</p>
</li>
<li>
<p>令牌窃取</p>
</li>
<li>
<p>PTH</p>
</li>
<li>
<p>PTT</p>
</li>
<li>
<p>Ntds.dit获取与实际应用</p>
</li>
<li>
<p>Win2008 GPP组策略首选项漏洞</p>
</li>
<li>
<p>非约束委派攻击</p>
</li>
<li>
<p>约束委派攻击</p>
</li>
<li>
<p>基于资源的约束委派攻击</p>
</li>
<li>
<p>NetLogon</p>
</li>
<li>
<p>基于krbtgt构造金票据进行权限维持</p>
</li>
<li>
<p>白银票据PTK</p>
</li>
<li>
<p>NTLM-Relay攻击</p>
</li>
<li>
<p>Skeleton Key权限维持</p>
</li>
<li>
<p>Hook PasswordChangeNotify拦截密码</p>
</li>
<li>
<p>SSP获取登录凭据</p>
</li>
<li>
<p>GPO批量控制器域内主机</p>
</li>
<li>
<p>AS-REP Roasting攻击</p>
</li>
<li>
<p>跨域攻击：从子域到主域</p>
</li>
<li>
<p>域外用户的域渗透</p>
</li>
<li>
<p>域内指定机器权限获取</p>
</li>
<li>
<p>Windows域外远程获取目标域内数据</p>
</li>
<li>
<p>Linux域外远程获取目标域内数据</p>
</li>
</ul>
<h2 id="exchange攻击">Exchange攻击</h2>
<ul>
<li>
<p>存活判断</p>
</li>
<li>
<p>目标接口获取</p>
</li>
<li>
<p>定位服务器</p>
</li>
<li>
<p>用户枚举</p>
</li>
<li>
<p>密码喷洒</p>
</li>
<li>
<p>NTLM Relay</p>
</li>
<li>
<p>CVE-2020-0688</p>
</li>
<li>
<p>导出指定邮件</p>
</li>
</ul>
<h2 id="杀软对抗">杀软对抗</h2>
<ul>
<li>
<p>白名单绕过</p>
</li>
<li>
<p>Payload编写</p>
</li>
<li>
<p>Bypass add user</p>
</li>
<li>
<p>CS profile</p>
</li>
<li>
<p>域前置</p>
</li>
<li>
<p>ACL隐藏Bind Shell</p>
</li>
</ul>
<h2 id="权限维持">权限维持</h2>
<ul>
<li>
<p>windows</p>
<ul>
<li>开机自启</li>
<li>计划任务</li>
<li>注册表</li>
<li>WMI</li>
<li>Bitsadmin</li>
<li>DLL劫持</li>
<li>COM劫持</li>
<li>Bootkit</li>
<li>Winlogon登录初始化</li>
<li>Logon Scripts</li>
</ul>
</li>
<li>
<p>Linux</p>
</li>
<li>
<p>crontab计划任务</p>
</li>
<li>
<p>ssh公钥免密</p>
</li>
<li>
<p>rootkit</p>
</li>
<li>
<p>web</p>
<ul>
<li>
<p>webshell隐藏</p>
<ul>
<li>attrib</li>
</ul>
</li>
<li>
<p>文件后门</p>
</li>
<li>
<p>中间件后门</p>
</li>
</ul>
</li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>

  </article>

    </main>
  </body>
</html>
